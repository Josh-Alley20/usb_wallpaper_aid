DELAY 3000  // Wait for 3 seconds to let the system get ready
GUI r       // Windows Key + R to open the Run dialog
DELAY 500
STRING cmd // opean CMD
ENTER
DELAY 500
STRING python -c "import os,shutil,subprocess,ctypes,logging,requests;from pathlib import Path;def combine(base,file_name)->str:return os.path.join(base,file_name);class APP_PATHS:BASE=r'C:\auto_wallpaper_switcher';BAT_FILE=combine(BASE,'wallpaper_scheduler.bat');PYTHON_FILE=combine(BASE,'wallpaper_afternoon.py');DESKTOP=Path.home()/'Desktop';LOG_FILE=combine(BASE,'wallpaper_switcher.log');class IMAGE_FILES:ESC_ROOM="Escape_Room_WP.png";CTF="CTF_WP.png";ESC_ROOM_URL="https://raw.githubusercontent.com/Josh-Alley20/usb_wallpaper_aid/main/Escape_Room_WP.png";CTF_URL="https://raw.githubusercontent.com/Josh-Alley20/usb_wallpaper_aid/main/CTF_WP.png";@staticmethod;def base(file_name:str)->str:return combine(APP_PATHS.BASE,file_name);def download_image(url:str,dest_path:str)->None:try:response=requests.get(url,stream=True);response.raise_for_status();with open(dest_path,'wb')as file:shutil.copyfileobj(response.raw,file);logging.info(f'Downloaded image from {url} to {dest_path}')except Exception as e:logging.error(f'Failed to download image from {url}. Error: {e}');def setup_logging_and_create_folder(path:str)->None:try:os.makedirs(path,exist_ok=True);print(f'Created or verified folder: {path}')except Exception as e:print(f'Failed to create folder: {path}. Error: {e}');logging.basicConfig(filename=APP_PATHS.LOG_FILE,level=logging.DEBUG,format='%(asctime)s - %(levelname)s - %(message)s');logging.info(f'Logging initialized in {APP_PATHS.LOG_FILE}');def write_file(file_path:str,content:str)->None:try:with open(file_path,'w')as file:file.write(content);logging.info(f'File written: {file_path}')except Exception as e:logging.error(f'Failed to write file: {file_path}. Error: {e}');def create_python_script()->None:python_content=f"""import ctypes\nimport shutil\nimport os\nfrom pathlib import Path\nSPI_SETDESKWALLPAPER = 20\ndesktop = Path.home() / 'Desktop'\nwallpaper_path = r'{IMAGE_FILES.base(IMAGE_FILES.ESC_ROOM)}'\nshutil.copy(wallpaper_path, desktop)\nwallpaper_on_desktop = str(desktop / Path(wallpaper_path).name)\nctypes.windll.user32.SystemParametersInfoW(SPI_SETDESKWALLPAPER,0,wallpaper_on_desktop,3)\nos.remove(wallpaper_on_desktop)""";write_file(APP_PATHS.PYTHON_FILE,python_content);def create_bat_file()->None:bat_content=f"@echo off\ncd {APP_PATHS.BASE}\npython {APP_PATHS.PYTHON_FILE}\n";write_file(APP_PATHS.BAT_FILE,bat_content);def schedule_task(task_name:str,bat_file_path:str,time,date)->None:schedule_command=(f'schtasks /create /tn "{task_name}" /tr "{bat_file_path}" /sc once /st {time} /sd {date} /f');logging.info(f'Executing command: {schedule_command}');try:subprocess.run(schedule_command,shell=True,check=True);logging.info(f'Task "{task_name}" created to run on {date} at {time}.')except subprocess.CalledProcessError as e:logging.error(f'Failed to create the scheduled task. Error: {e}');def change_current_wallpaper()->None:SPI_SETDESKWALLPAPER=20;desktop=Path.home()/'Desktop';wallpaper_path=IMAGE_FILES.base(IMAGE_FILES.CTF);try:shutil.copy(wallpaper_path,desktop);logging.info(f'Copied wallpaper to desktop: {wallpaper_path}');wallpaper_on_desktop=combine(APP_PATHS.DESKTOP,IMAGE_FILES.CTF);ctypes.windll.user32.SystemParametersInfoW(SPI_SETDESKWALLPAPER,0,wallpaper_on_desktop,3);logging.info(f'Set wallpaper: {wallpaper_on_desktop}');os.remove(wallpaper_on_desktop);logging.info(f'Removed wallpaper from desktop: {wallpaper_on_desktop}')except Exception as e:logging.error(f'Failed to change wallpaper. Error: {e}');def main()->None:setup_logging_and_create_folder(APP_PATHS.BASE);download_image(IMAGE_FILES.ESC_ROOM_URL,IMAGE_FILES.base(IMAGE_FILES.ESC_ROOM));download_image(IMAGE_FILES.CTF_URL,IMAGE_FILES.base(IMAGE_FILES.CTF));create_python_script();create_bat_file();schedule_task(task_name='WallpaperSchedulerTask',bat_file_path=APP_PATHS.BAT_FILE,time='12:00',date='09/12/2024');change_current_wallpaper();if __name__=='__main__':main()"   // Run Python code directly
ENTER